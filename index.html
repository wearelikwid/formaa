<!DOCTYPE html>
<html lang="en">
<!-- Previous head and style sections remain exactly the same until the script tag -->
<head>
    <!-- All previous head content remains exactly the same -->
    <style>
        /* All previous styles remain exactly the same */
    </style>
</head>
<body>
    <div class="container">
        <h1>16 Week Workout Program</h1>
        <div id="errorContainer"></div>
        <div id="loadingIndicator" class="loading">Loading workout program...</div>
        <div class="weeks-container" id="weeksContainer"></div>
    </div>
    <script>
        // Main data storage
        let workoutProgram = {};
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', initializeApp);

        async function initializeApp() {
            try {
                await loadAllWeeks();
                hideLoadingIndicator();
            } catch (error) {
                showError('Failed to initialize the workout program. Please try again.');
                console.error('Initialization error:', error);
            }
        }

        // Loading functions
        async function loadAllWeeks() {
            const weeks = 16;
            const loadingPromises = [];

            for (let week = 1; week <= weeks; week++) {
                loadingPromises.push(loadWeekData(week));
            }

            await Promise.all(loadingPromises);
            renderWorkoutProgram();
        }

        async function loadWeekData(weekNumber) {
            try {
                const response = await fetch(`week${weekNumber}.JSON`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const weekData = await response.json();
                workoutProgram[`week${weekNumber}`] = weekData;
                return weekData;
            } catch (error) {
                console.error(`Error loading week ${weekNumber}:`, error);
                workoutProgram[`week${weekNumber}`] = null;
                showError(`Failed to load Week ${weekNumber}`);
            }
        }

        // Rendering functions
        function renderWorkoutProgram() {
            const container = document.getElementById('weeksContainer');
            container.innerHTML = ''; // Clear container

            for (let week = 1; week <= 16; week++) {
                const weekData = workoutProgram[`week${week}`];
                if (weekData) {
                    const weekCard = createWeekCard(week, weekData);
                    container.appendChild(weekCard);
                }
            }
        }

        function createWeekCard(weekNumber, weekData) {
            const weekCard = document.createElement('div');
            weekCard.className = 'week-card fade-in';
            weekCard.innerHTML = `
                <h2 class="week-title">Week ${weekNumber}</h2>
                ${createWorkoutTypes(weekData)}
            `;
            return weekCard;
        }

        function createWorkoutTypes(weekData) {
            const workoutTypes = [
                { display: 'Upper Body', key: 'upperBody' },
                { display: 'Lower Body', key: 'lowerBody' },
                { display: 'Core', key: 'core' },
                { display: 'Full Body', key: 'fullBody' }
            ];

            // Access the nested week structure
            const weekDataContent = weekData.week1;

            return workoutTypes.map(type => {
                const workoutData = weekDataContent[type.key];
                
                return `
                    <div class="workout-type">
                        <div class="workout-header" onclick="toggleWorkout(this)">
                            ${type.display}
                        </div>
                        <div class="workout-content">
                            ${formatWorkoutData(workoutData)}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function formatWorkoutData(workoutData) {
            if (!workoutData) {
                return '<div class="exercise-item">No workout data available</div>';
            }

            if (Array.isArray(workoutData)) {
                return workoutData.map(exercise => {
                    if (typeof exercise === 'string') {
                        return `
                            <div class="exercise-item">
                                <div class="exercise-name">${exercise}</div>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="exercise-item">
                                <div class="exercise-name">${exercise.name || 'Unnamed Exercise'}</div>
                                <div class="exercise-details">
                                    ${exercise.sets ? `Sets: ${exercise.sets}<br>` : ''}
                                    ${exercise.reps ? `Reps: ${exercise.reps}<br>` : ''}
                                    ${exercise.duration ? `Duration: ${exercise.duration}<br>` : ''}
                                    ${exercise.weight ? `Weight: ${exercise.weight}<br>` : ''}
                                    ${exercise.notes ? `Notes: ${exercise.notes}` : ''}
                                </div>
                            </div>
                        `;
                    }
                }).join('');
            }

            return `
                <div class="exercise-item">
                    <pre>${JSON.stringify(workoutData, null, 2)}</pre>
                </div>
            `;
        }

        // UI Interaction functions
        function toggleWorkout(element) {
            const content = element.nextElementSibling;
            const isExpanded = element.classList.contains('active');

            // Close all other workout contents
            const allHeaders = document.querySelectorAll('.workout-header');
            const allContents = document.querySelectorAll('.workout-content');
            
            allHeaders.forEach(header => header.classList.remove('active'));
            allContents.forEach(content => content.classList.remove('show'));

            // Toggle current workout
            if (!isExpanded) {
                element.classList.add('active');
                content.classList.add('show');
            }
        }

        // Utility functions
        function showError(message) {
            const errorContainer = document.getElementById('errorContainer');
            const errorElement = document.createElement('div');
            errorElement.className = 'error fade-in';
            errorElement.textContent = message;
            errorContainer.appendChild(errorElement);

            // Remove error after 5 seconds
            setTimeout(() => {
                errorElement.remove();
            }, 5000);
        }

        function hideLoadingIndicator() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            loadingIndicator.style.display = 'none';
        }
    </script>
</body>
</html>
